{% extends 'user/base.html'%}
{% load static %}
{% block content %}
 <!-- HEADER -->
 <div class="header bg-dark pb-5">
  <div class="container-fluid">

    <!-- Body -->
    <div class="header-body">
      <div class="row align-items-end">
        <div class="col">
          
          <!-- Pretitle -->
          <h1 class="header-pretitle text-secondary" style="color:'white'">
            ATC
          </h1>

          <!-- Title -->
<script type="text/javascript">
function angle(start, end) {
var p1 = {
x: start.offsetLeft,
y: start.offsetTop
};
var p2 = {
x: end.offsetLeft,
y: end.offsetTop
};

var angleDeg = (Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI);

if(angleDeg >= 360){
angleDeg -= 360;
}

return angleDeg;
}

function fly(target, to) {
var airplane = document.querySelector('#plane' + target);
var destination = document.querySelector('#local' + to);
var from = parseInt(airplane.dataset.position);
var to = to || 0;

if (from !== to) {
var airplaneRect = airplane.getBoundingClientRect();
var destinationRect = destination.getBoundingClientRect();
var destinationY = Math.floor(destinationRect.left);
var destinationX = Math.floor(destinationRect.top);
var airplaneY = Math.floor(airplaneRect.left);
var airplaneX = Math.floor(airplaneRect.top);
var newAngle = angle(airplane, destination);

airplane.style.transform = 'rotate(' + newAngle + 'deg)';
airplane.dataset.position = to;

airplane.classList.add('move');
function updatePosition () {
airplane.classList.remove('move');
airplane.style.transform = "rotate(0deg)";
}
setTimeout(updatePosition, 1100);
};
}

// Simulator
setInterval(function(){
var xxx = Math.floor(Math.random() * 13);
switch (xxx) {    case  0: fly(0, 0); break;


case  1: fly(0, 3); break;
case  2: fly(0, 1); break;
case  6: fly(1, 1); break;
case  7: fly(2, 1); break;
case  8: fly(3, 1); break;
case 10: fly(0, 2); break;
case 11: fly(1, 2); break;
case 12: fly(2, 2); break;
case 13: fly(3, 2); break;
case 15: fly(0, 3); break;
case 16: fly(1, 3); break;
case 17: fly(2, 3); break;
case 18: fly(3, 3); break;
}
}, 2001)  
</script>
<style type="text/css">
* {
box-sizing: border-box;
margin: 0;
padding: 0;
font-family: sans-serif;
}

html,
body { height: 100% }

.location, .location:before, .airplane, .airplane:before {
position: absolute;
width: 70px;
height: 75px;
transition: left 1.4s ease-in-out, top 1.4s ease-in-out, transform 0.5s cubic-bezier(0,.4,.4,1);
text-indent: 37px;
line-height: 75px;
color: #fff;
font-weight: bold;
}

.airplane {
z-index: 3;
}

.airplane:before {
display: block;
content: "";
background-image:
url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABLAQMAAAD3fmMZAAAABlBMVEX///8fHx8C6jRYAAAAAXRSTlMAQObYZgAAAJBJREFUeAF90sGxRhEMBeDcPl4tlEZpSlGCZRZG3o2fg7kmWWQ+CxwZpOVoVohTkqA88GwqpvgjkmqqmRJbcSh0/UGuK2lfilBS5VNZVU6VKf82L6ziFyJ9/asIZYgpDFUSUwHCXqjsd/Cj4JmlrXz39PdXRghzcdCaHx2STWSpmaqGHmFT5aKMU5bS9z97bf/GyPaRIoVziwAAAABJRU5ErkJggg==');
background-repeat: no-repeat;
background-size: cover;
background-position: center;
z-index: -1;
}

.location {
background: #ccc !important;
outline: 20px solid #ccc;
border: 0;
text-indent: 0;
}

.location:before {
content:"H";
font-size: 60px;
text-indent: 0;
text-align: center;
}

[data-position="0"] {left: 100px; top: 200px }
[data-position="1"] {left: 780px; top: 200px }


.airplane.move:before {
animation: flying 1.4s ease-in-out;
}

@keyframes flying {
0% {
transform: scale(1);
-webkit-filter: drop-shadow(0 0 0 rgba(0,0,0,0));
filter:         drop-shadow(0 0 0 rgba(0,0,0,0)); 
}
50% {
transform: scale(1.3);
-webkit-filter: drop-shadow(10px 0 15px rgba(0,0,0,0.8));
filter:         drop-shadow(10px 0 15px rgba(0,0,0,0.8)); 
}
100% {
transform: scale(1);
-webkit-filter: drop-shadow(0 0 0 rgba(0,0,0,0));
filter:         drop-shadow(0 0 0 rgba(0,0,0,0));
}
} 
</style>

<div id="local0" class="location" data-position="0"></div>
<div id="local1" class="location" data-position="1"></div>

<div id="plane0" class="airplane" data-position="0">0</div>
<div id="plane1" class="airplane" data-position="1">1</div>



        </div>
        
      </div> <!-- / .row -->
    </div> <!-- / .header-body -->

    <!-- Footer -->
    

  </div>
</div> <!-- / .header -->

<div class="container-fluid">
  <div class="row">
    
    
  </div> <!-- / .row -->
  <div class="row">
    <div class="col-12 col-lg-6 col-xl">
      
      <!-- Card -->
      
    
      
      <!-- Card -->
      
      
      <!-- Card -->
      
      
      <!-- Card -->
      
        
    </div>
  </div> <!-- / .row -->
  <br><br><br><br><br><br><br><br><br>
  <div class="row">
    <div class="col-12 col-xl-4">

      <!-- Projects -->
      <div class="card">
        <div class="card-header">
          <div class="row align-items-center">
            <div class="col">
              
              <!-- Title -->
              <h4 class="card-header-title">
                List of ATC
              </h4>

            </div>
            <div class="col-auto">

              <!-- Link -->
              
              
            </div>
          </div> <!-- / .row -->
        </div>
        <div class="card-body">


          {% for act in atcs %}
          <div class="row align-items-center">
            <div class="col-auto">
              
              <!-- Avatar -->
              

            </div>
            <div class="col ml-n2">

              <!-- Title -->
              <h4 class="card-title mb-1">
                <a href="{% url 'atc_details' act.id %}">{{ act.name }}</a>
                <a href="#">&nbsp;{{ act.id }}</a>
              </h4>

              <!-- Time -->
              <p class="card-text small text-muted">
                <time datetime="2018-05-24">Runways : {{ act.runways }}, Takeoff Limit : {{ act.takeoff_limit }}, Landing Limit : {{ act.landing_limit }} </time>
              </p>
              
            </div>
            
          </div> <!-- / .row -->

          <!-- Divider -->
          <hr>
          {% endfor %}

          
        </div> <!-- / .card-body -->
      </div> <!-- / .card -->            

    </div>
    <div class="col-12 col-xl-8">
      
      <!-- Goals -->
      <div class="card">
        <div class="card-header">
          <div class="row align-items-center">
            <div class="col">

              <!-- Title -->
              <h4 class="card-header-title">
                Flight
              </h4>

            </div>
            
          </div> <!-- / .row -->
        </div>
        <div class="table-responsive mb-0" data-toggle="lists" data-lists-values='["goal-project", "goal-status", "goal-progress", "goal-date"]'>
          <table class="table table-sm table-nowrap card-table">
            <thead>
              <tr>
                <th>
                  <a href="#" class="text-muted sort" data-sort="goal-project">
                    Name
                  </a>
                </th>
                <th>
                  <a href="#" class="text-muted sort" data-sort="goal-status">
                    Starting ATC
                  </a>
                </th>
                <th>
                  <a href="#" class="text-muted sort" data-sort="goal-progress">
                    Ending ATC
                  </a>
                </th>
                <th>
                  <a href="#" class="text-muted sort" data-sort="goal-date">
                    Expected Time
                  </a>
                </th>
                <th>
                    <a href="#" class="text-muted sort" data-sort="goal-date">
                      State
                    </a>
                  </th>
               
                <th></th>
              </tr>
            </thead>
            <tbody class="list">
              {% for flight in flights %}
              <tr>
                <td class="goal-project">
                  <a href="{% url 'flight_details' flight.id %}">
                  {{ flight.name }}</a>
                </td>
                <td class="goal-status">
                  <span class="text-warning">‚óè</span> {{ flight.starting_atc }}
                </td>
                <td class="goal-progress">
                    {{ flight.ending_atc }}
                </td>
                <td class="goal-date">
                  <time datetime="2018-10-24">{{ flight.expected_end }}</time>
                </td>
                <td class="goal-date1">
                    <time datetime="2018-10-24">{{ flight.get_states_display }}</time>
                  </td>
               
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div> <!-- / .row -->
</div>


{% endblock %}

<script>
  let time = document.querySelector('.goal-date');
  let past_time = time.element.childNode.innerText;
  let ptime = new Date();
  let present_time = ptime.getHours() + ":" + ptime.getMinutes() + ":" + ptime.getSeconds();
  if(past_time == present_time){
    
  }

</script>





    

 